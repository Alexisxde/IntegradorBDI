USE ADMINISTRACION_HOTEL;
GO;
--Crear dos usuarios de base de datos.
CREATE USER GERENTE_CARLOS WITH PASSWORD = '95963784';
CREATE USER SUPERVISOR_ALEXIS WITH PASSWORD = '44542230';
--A un usuario darle el permiso de administrador y al otro usuario solo permiso de lectura.
GRANT SELECT ON ADMINISTRACION_HOTEL; TO SUPERVISOR_ALEXIS;
GRANT SELECT, INSERT, UPDATE, DELETE ON ADMINISTRACION_HOTEL TO GERENTE_CARLOS;
GO;
--Utilizar los procedimientos almacenados creados anteriormente.
EXEC CARGOS.agregarCargo @IdCargo = N'10' @NombreCargo = N'Masajista';
GO;
--Al usuario con permiso de solo lectura, darle permiso de ejecución sobre este procedimiento.
GRANT EXECUTE ON OBJECT::CARGOS.agregarCargo TO SUPERVISOR_ALEXIS;
GO;
--Realizar INSERT con sentencia SQL sobre la tabla del procedimiento con ambos usuarios.
--Insercion con usuario 1.
INSERT INTO CARGOS(ID_CARGO,NOMBRE) VALUES (12, 'Recepcionista');
--Insercion con usuario 2
INSERT INTO CARGOS(ID_CARGO,NOMBRE) VALUES (13, 'Limpieza salón');
--Realizar un INSERT a través del procedimiento almacenado con el usuario con permiso de solo lectura.
--Inserción con el usuario solo lectura
EXECUTE AS USER = 'SUPERVISOR_ALEXIS';
GO
INSERT INTO CARGOS (ID_CARGO,NOMBRE) VALUES (10, 'Masajista');
GO
REVERT;
--Inserción con el usuario admin
EXECUTE AS USER = 'GERENTE_CARLOS';
GO
INSERT INTO CARGOS (ID_CARGO,NOMBRE) VALUES (11, 'Cocinero');
GO
REVERT;
